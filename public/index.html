<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>UniBot ‚Äî Modern Chat UI</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="stylesheet" href="/style.css">
</head>
<body>
  <div class="app" id="appRoot">
    <!-- SIDEBAR -->
    <aside class="sidebar" id="sidebar" aria-hidden="false">
      <div class="sidebarTop">
        <div class="brand">UniBot</div>
        <div class="spacer"></div>
        <button id="sidebarCloseBtn" class="btn small" title="Close sidebar">‚úï</button>
      </div>

      <div class="controls">
        <button id="newChatBtn" class="btn">+ New Chat</button>
        <div style="flex:1"></div>
        <button id="themeToggle" class="btn small btn-ghost" title="Toggle theme">üåô</button>
      </div>

      <div class="userRow">
        <div id="userInfo" class="small">Not signed in</div>
        <div class="authRow">
          <button id="loginBtn" class="btn small">Login (Google)</button>
          <button id="logoutBtn" class="btn small" style="display:none;background:#ef4444">Logout</button>
        </div>
      </div>

      <div style="margin-top:6px;font-weight:700;color:var(--text)">Chats</div>

      <div id="sessions" class="sessions" aria-live="polite">
        <div class="small no-sessions" style="padding:10px;color:var(--muted)">No chats yet ‚Äî press "New Chat" to start</div>
      </div>
    </aside>

    <!-- MAIN -->
    <main class="main" id="mainContent">
      <div class="panel" id="mainPanel">
        <div class="topbar">
          <select id="mode" aria-label="Mode selector">
            <option value="academic">Academic Expert</option>
            <option value="study_buddy">Study Buddy</option>
            <option value="tutor">Strict Tutor</option>
            <option value="friendly">Friendly Assistant</option>
            <option value="motivational">Motivational Coach</option>
          </select>

          <div class="meta small" id="sessionMeta">Sign in to load chats</div>

          <div style="margin-left:12px"></div>
          <button id="studentToolsBtn" class="btn btn-ghost small" title="Student Tools">üìö Student Tools</button>
          <button id="clearChatBtn" class="btn btn-ghost small" title="Clear current chat" style="display:none;">üóë Clear</button>
          <button id="sidebarOpenDesktop" class="btn btn-ghost small" title="Open sessions" style="margin-left:auto">‚ò∞ Sessions</button>
        </div>

        <div id="chatArea" class="chatArea" role="log" aria-live="polite">
          <div id="emptyHint" class="small" style="color:var(--muted);padding:20px;text-align:center;">
            <div style="font-size:48px;margin-bottom:16px;">üëã</div>
            <div style="font-size:18px;font-weight:600;margin-bottom:8px;color:var(--text);">Welcome to UniBot!</div>
            <div style="margin-bottom:16px;">Start a new chat ‚Äî sign in to save your conversation.</div>
            <div style="font-size:14px;color:var(--muted-2);">
              Try: <code style="background:var(--panel-2);padding:4px 8px;border-radius:6px;">/help</code> to see available commands
            </div>
          </div>
          <div id="chatbox" style="display:flex;flex-direction:column;gap:12px;"></div>
        </div>

        <div class="composer">
          <textarea id="prompt" placeholder="Ask UniBot anything... (Press Enter to send, Shift+Enter for new line)" rows="2" spellcheck="false"></textarea>
          <button id="stopBtn" class="stopBtn" style="display:none;" title="Stop generating">‚èπ Stop</button>
          <button id="sendBtn" class="sendBtn">Send</button>
        </div>
      </div>
    </main>
  </div>

  <!-- Firebase compat (unchanged) -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>

  <!-- Student Tools Modal -->
  <div id="studentToolsModal" class="student-tools-modal" style="display:none;">
    <div class="student-tools-modal-content">
      <div class="student-tools-header">
        <h2>üìö Student Tools</h2>
        <button id="closeStudentTools" class="close-btn" title="Close">‚úï</button>
      </div>
      <div class="student-tools-tabs">
        <button class="tool-tab active" data-tool="cgpa">Calculate CGPA</button>
        <button class="tool-tab" data-tool="gpa">Calculate GPA</button>
        <button class="tool-tab" data-tool="grade">Grade Converter</button>
        <button class="tool-tab" data-tool="reminders">Reminders</button>
        <button class="tool-tab" data-tool="planner">Study Planner</button>
        <button class="tool-tab" data-tool="pdfnotes">PDF Notes</button>
      </div>
      <div class="student-tools-body">
        <!-- CGPA Calculator -->
        <div id="tool-cgpa" class="tool-panel active">
          <h3>Calculate CGPA</h3>
          <p class="tool-description">Enter your semester GPAs to calculate your Cumulative Grade Point Average</p>
          <div id="cgpa-inputs"></div>
          <button id="add-semester" class="btn-small">+ Add Semester</button>
          <div class="result-box">
            <div class="result-label">Your CGPA:</div>
            <div id="cgpa-result" class="result-value">-</div>
          </div>
        </div>

        <!-- GPA Calculator -->
        <div id="tool-gpa" class="tool-panel">
          <h3>Calculate GPA</h3>
          <p class="tool-description">Enter your subjects with credits and grades to calculate GPA for a semester</p>
          <div id="gpa-inputs"></div>
          <button id="add-subject" class="btn-small">+ Add Subject</button>
          <div class="result-box">
            <div class="result-label">Your GPA:</div>
            <div id="gpa-result" class="result-value">-</div>
          </div>
        </div>

        <!-- Grade Converter -->
        <div id="tool-grade" class="tool-panel">
          <h3>Grade Converter</h3>
          <p class="tool-description">Convert between different grading systems</p>
          <div class="grade-converter">
            <div class="converter-input">
              <label>From:</label>
              <select id="grade-from-system">
                <option value="percentage">Percentage (%)</option>
                <option value="cgpa10">CGPA (10 scale)</option>
                <option value="cgpa4">CGPA (4 scale)</option>
                <option value="letter">Letter Grade</option>
              </select>
              <input type="text" id="grade-input" placeholder="Enter value">
            </div>
            <div class="converter-output">
              <label>To:</label>
              <div id="grade-conversions"></div>
            </div>
          </div>
        </div>

        <!-- Reminders -->
        <div id="tool-reminders" class="tool-panel">
          <h3>Reminders</h3>
          <p class="tool-description">Add and manage your study reminders</p>
          <div class="reminder-form">
            <input type="text" id="reminder-title" placeholder="Reminder title">
            <textarea id="reminder-desc" placeholder="Description (optional)"></textarea>
            <input type="datetime-local" id="reminder-date">
            <button id="add-reminder" class="btn-primary">Add Reminder</button>
          </div>
          <div id="reminders-list" class="reminders-list"></div>
        </div>

        <!-- Study Planner -->
        <div id="tool-planner" class="tool-panel">
          <h3>Study Planner</h3>
          <p class="tool-description">Plan your study schedule for the week</p>
          <div class="planner-form">
            <input type="text" id="planner-subject" placeholder="Subject name">
            <input type="date" id="planner-date">
            <input type="time" id="planner-time">
            <input type="number" id="planner-duration" placeholder="Duration (hours)" min="0.5" step="0.5">
            <button id="add-study-session" class="btn-primary">Add Session</button>
          </div>
          <div id="planner-calendar" class="planner-calendar"></div>
        </div>

        <!-- PDF Notes -->
        <div id="tool-pdfnotes" class="tool-panel">
          <h3>PDF Notes</h3>
          <p class="tool-description">Browse and download study materials by branch and semester</p>
          <div class="pdf-filters">
            <select id="pdf-branch-select">
              <option value="">Select Branch</option>
              <option value="cse">CSE</option>
              <option value="ece">ECE</option>
              <option value="ise">ISE</option>
            </select>
            <select id="pdf-semester-select">
              <option value="">Select Semester</option>
            </select>
          </div>
          <div id="pdf-notes-list" class="pdf-notes-list"></div>
        </div>
      </div>
    </div>
  </div>

  <script src="/script.js" defer></script>
  <script src="/student-tools.js" defer></script>
</body>
</html>
